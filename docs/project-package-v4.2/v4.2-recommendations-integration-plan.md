# Uroflow Project Package v4.2: Analysis and Integration Plan

Date: 2026-02-25

## Scope analyzed
- Final package: `Uroflow_Project_Package_v4.2.zip`
- Submission tree analyzed: `Submission_Build_v4.2/**`
- Focused integration targets:
  - `10_Pilot_Automation` (scripts/config/runbooks)
  - `02_Algorithm_and_ML/ios_capture_contract_schema_v1.0.json`
  - package inventories and release traceability assets

## Key deltas vs current repo baseline (v2.8 stack)
1. New pilot readiness stack in v4.2:
   - pre-freeze gates,
   - record-level gates,
   - stand-pose drift dashboard,
   - privacy content guardrails v2,
   - on-device privacy live guardrails,
   - freeze-kit and ethics pack builders.
2. New governance artifacts:
   - freeze-kit workflow and DHF freeze-event logging,
   - multi-site coverage and weekly reporting.
3. New schema-driven iOS capture contract validation path.

## Integrated into repository
1. Added versioned automation package:
   - `scripts/pilot_automation_v4_2/**`
   - includes scripts/configs/run wrappers and sample dataset.
2. Added iOS contract schema for local validation:
   - `scripts/pilot_automation_v4_2/schemas/ios_capture_contract_schema_v1.0.json`
3. Added package extraction/inventory utility:
   - `scripts/extract_project_package_v4_2.py`
4. Generated v4.2 inventories:
   - `docs/project-package-v4.2/package_manifest_v4.2.csv`
   - `docs/project-package-v4.2/module_summary_v4.2.csv`
   - `docs/project-package-v4.2/docx_inventory_v4.2.csv`
   - `docs/project-package-v4.2/xlsx_sheet_inventory_v4.2.csv`
   - `docs/project-package-v4.2/source_readme_v4.2.txt`
   - `docs/project-package-v4.2/sheets/*`
5. Improved portability of v4.2 scripts for repo-local usage:
   - fixed `build_dataset_release_bundle_guarded.py` indentation/runtime scope bug,
   - added robust config path fallback to local automation root in:
     - `compute_record_level_gates.py`
     - `compute_accuracy_acceptance.py`
     - `run_pre_freeze_gates.py`
     - `run_stand_pose_drift_dashboard.py`
     - `run_coverage_dashboard.py`
     - `validate_privacy_live_guardrails.py`
     - `validate_privacy_content_guardrails_v2.py`
   - added local schema fallback in `validate_ios_capture_contract.py`.
6. Extended CI smoke checks to include v4.2 automation:
   - `/.github/workflows/ci.yml` now installs `jsonschema` in pilot-automation smoke job,
   - executes v4.2 script `--help` checks,
   - runs minimal end-to-end sample pipeline for sync/qa/ios-contract/record-level/pre-freeze outputs.

## Handling of unexpected duplicate docs (`* 2.md`)
Checked files in repo root docs:
- `clinical-protocol-one-pager-v0.1 2.md` and `coreml-architecture-v0.1 2.md` are byte-identical to originals.
- `mvp-v0.1-execution-plan 2.md` and `regulatory-matrix-ru-cn-eu-us-v0.1 2.md` are truncated copies (no new content).
Decision: do not merge these copies into canonical docs.

## Practical outcome
Repository now contains a usable v4.2 automation lane in parallel with v2.8:
- no breaking replacement of validated v2.8 scripts,
- v4.2 assets available for pilot freeze/readiness workflows,
- CI guards against obvious v4.2 script regressions.

## Recommended next implementation step
Pilot one clinic with `scripts/pilot_automation_v4_2` and lock the exact operational profile:
- required record-level gates,
- pass/fail thresholds for pre-freeze,
- final freeze-kit acceptance criteria before submission packaging.
